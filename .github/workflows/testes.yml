name: Testes Automatizados

on:
  workflow_dispatch:  # Aciona a pipeline manualmente

jobs:
  testes:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout do código
      uses: actions/checkout@v2

    - name: Configurar ambiente Python
      uses: actions/setup-python@v2
      with:
        python-version: 3.8

    - name: Instalar dependências
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
        pip install pytest

    - name: Executar testes
      run: |
        docker run --rm -d -p 4444:4444 -v /dev/shm:/dev/shm selenium/standalone-chrome:latest
        pytest

    - name: Parar contêiner do Selenium
      run: |
        docker stop $(docker ps -a -q --filter ancestor=selenium/standalone-chrome)
